!function(t){var i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(s,n,function(i){return t[i]}.bind(null,n));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="/",e(e.s=2)}([function(t,i){t.exports="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nattribute vec3 a_position;\nattribute vec4 a_color;\nattribute vec2 a_uv;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\n\nuniform vec2 u_resolution;\nuniform float u_time;\n\nuniform mat4 u_model;\nuniform mat4 u_view;\nuniform mat4 u_projection;\n\nvoid main() {\n  v_color = a_color;\n  v_uv = a_uv;\n\n  vec3 pos = a_position + vec3(2., 0., 0.);\n\n  gl_Position = vec4(a_position, 1.0);\n}"},function(t,i){t.exports="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#define PI 3.14159265359\n#define TWO_PI 6.28318530718\n\nconst float MAX_ITER = 8192.;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\n\nuniform vec2 u_resolution;\nuniform float u_time;\n\nuniform vec2 u_position;\nuniform vec2 u_scale;\nuniform float u_rotation;\n\nuniform float u_radius;\n\nuniform vec2 u_z;\nuniform vec2 u_c;\nuniform bool u_julia;\n\nuniform bool u_frac;\n\nuniform mat4 u_model;\nuniform mat4 u_view;\nuniform mat4 u_projection;\n\nvec2 rot_2d(vec2 p, vec2 pivot, float a) {\n  float s = sin(a);\n  float c = cos(a);\n  p -= pivot;\n  p = vec2(p.x * c - p.y * s, p.x * s + p.y * c);\n  p += pivot;\n  return p;\n}\n\nfloat map(float x, float in_min, float in_max, float out_min, float out_max) {\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n\nint map(int x, int in_min, int in_max, int out_min, int out_max) {\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n\nfloat mandelbrot(vec2 _z, vec2 _c, float max_iter, float radius,\n                 bool fractions) {\n  float r2 = radius * radius;\n  vec2 z = _z;\n  vec2 c = _c;\n\n  float iterations = 0.;\n  for (float i = 0.; i < MAX_ITER; i++) {\n    if (i > max_iter)\n      break;\n\n    z = vec2(z.x * z.x - z.y * z.y, 2. * z.x * z.y) + c;\n\n    if (dot(z, z) > r2)\n      break;\n\n    iterations++;\n  }\n\n  if (fractions) {\n    float dist = length(z);\n    float frac_iter = (dist - radius) / (r2 - radius);\n    frac_iter = log2(log(dist) / log(radius));\n    iterations -= frac_iter;\n  }\n\n  return iterations;\n}\n\nvoid main() {\n  vec2 uv = ((v_uv - 0.5) * u_resolution) / u_resolution.y;\n\n  float max_iter = 512.; // Temp\n  vec3 color = vec3(0.);\n\n  vec2 scale = vec2(pow(2., u_scale.x), pow(2., u_scale.y));\n\n  float n = 0.;\n\n  if (u_julia)\n    n = mandelbrot(rot_2d(uv * scale + u_position, u_position, u_rotation), u_c,\n                   max_iter, u_radius, !u_frac);\n  else\n    n = mandelbrot(u_z, rot_2d(uv * scale + u_position, u_position, u_rotation),\n                   max_iter, u_radius, !u_frac);\n\n  float c = 0.;\n\n  if (n < max_iter - 5.) {\n    c = sqrt(n / max_iter);\n    c = clamp(c, 0., 1.);\n\n    vec3 rgb_comp = vec3(.3, 0.1, 0.5);\n    float freq = 12.;\n\n    color = (sin(rgb_comp * freq * c - PI / 2.) + 1.) * 0.5;\n  } else\n    color = vec3(0.);\n\n  gl_FragColor = vec4(color, 1.0);\n}"},function(t,i,e){e(5),e(3),t.exports=e(4)},function(t,i,e){"use strict";e.r(i)},function(t,i,e){"use strict";e.r(i)},function(t,i,e){"use strict";function s(t,i,e){return(1-e)*t+e*i}e.r(i);class n{constructor(){this.SPEED_DEFAULT=1,this.SMOOTH_STEP_DEFAULT=.03,this.SCALE_DEFAULT=[2,2],this.POSITION_DEFAULT=[0,0],this.ROTATION_SPEED_DEFAULT=Math.PI/60,this.RESOLUTION_DEFAULT=1,this.SCALE_SPEED_DEFAULT=1,this.resolution=this.RESOLUTION_DEFAULT,this.position=[...this.POSITION_DEFAULT],this.realPosition=[...this.position],this.scale=[...this.SCALE_DEFAULT],this.realScale=[...this.scale],this.rotation=0,this.realRotation=0,this.radius=10,this.direction=[0,0],this.smooth_step=this.SMOOTH_STEP_DEFAULT,this.isVisisble=!1,this.settings_container=document.querySelector("#settings"),document.querySelector("#btn-show-settings").addEventListener("click",this.onClick.bind(this)),this.resolution_scale_input=document.querySelector("#resolution-scale"),this.resolution_scale_input.addEventListener("change",this.onChange.bind(this))}get move_step_x(){return.5*Math.pow(2,this.scale[0])}get move_step_y(){return.5*Math.pow(2,this.scale[1])}update(t){const i=Math.sin(this.rotation),e=Math.cos(this.rotation);this.position[0]+=(this.move_step_x*this.direction[0]*e-this.move_step_x*this.direction[1]*i)*t.SElapsed,this.position[1]+=(this.move_step_y*this.direction[0]*i+this.move_step_y*this.direction[1]*e)*t.SElapsed,this.realScale[0]=s(this.realScale[0],this.scale[0],this.smooth_step)+(this.scale[0]-this.realScale[0])*t.SElapsed,this.realScale[1]=s(this.realScale[1],this.scale[1],this.smooth_step)+(this.scale[1]-this.realScale[1])*t.SElapsed,this.realRotation=s(this.realRotation,this.rotation,this.smooth_step)+(this.rotation-this.realRotation)*t.SElapsed,this.realPosition[0]=s(this.realPosition[0],this.position[0],this.smooth_step)+(this.position[0]-this.realPosition[0])*t.SElapsed,this.realPosition[1]=s(this.realPosition[1],this.position[1],this.smooth_step)+(this.position[1]-this.realPosition[1])*t.SElapsed}drag(t,i){this.realPosition[0]-=t*Math.pow(2,this.scale[0]),this.realPosition[1]+=i*Math.pow(2,this.scale[1]),this.position=[...this.realPosition]}zoom(t){this.scale[0]+=t*this.SCALE_SPEED_DEFAULT,this.scale[1]+=t*this.SCALE_SPEED_DEFAULT}rotate(t){this.rotation+=t*this.ROTATION_SPEED_DEFAULT}moveLeft(){this.direction[0]=-1}moveRight(){this.direction[0]=1}stopLeftRight(){this.direction[0]=0}moveUp(){this.direction[1]=1}moveDown(){this.direction[1]=-1}stopUpDown(){this.direction[1]=0}reset(){this.resetPosition(),this.resetRotation(),this.resetZoom()}resetPosition(){this.position=[...this.POSITION_DEFAULT]}resetRotation(){this.rotation=0}resetZoom(){this.scale=[...this.SCALE_DEFAULT]}onClick(t){this.isVisisble?this.settings_container.classList.add("hide"):this.settings_container.classList.remove("hide"),this.isVisisble=!this.isVisisble}onChange(t){this.resolution=parseFloat(this.resolution_scale_input.value)}}class o{constructor(t,i,e){this.gl=t,this.rendererID=this.createShader(i,e)}get id(){return this.rendererID}bind(){this.gl.useProgram(this.rendererID)}unbind(){this.gl.useProgram(0)}setUniform1f(t,i){this.gl.uniform1f(this.gl.getUniformLocation(this.rendererID,t),i)}setUniform2f(t,i,e){this.gl.uniform2f(this.gl.getUniformLocation(this.rendererID,t),i,e)}setUniform2fv(t,i){this.gl.uniform2fv(this.gl.getUniformLocation(this.rendererID,t),i)}setUniform1i(t,i){this.gl.uniform1i(this.gl.getUniformLocation(this.rendererID,t),i)}createShader(t,i){const e=this.gl.createProgram(),s=this.compileShader(this.gl.VERTEX_SHADER,t),n=this.compileShader(this.gl.FRAGMENT_SHADER,i);return this.gl.attachShader(e,s),this.gl.attachShader(e,n),this.gl.linkProgram(e),this.gl.getProgramParameter(e,this.gl.LINK_STATUS)||console.error("ERROR linking program!",this.gl.getProgramInfoLog(e)),this.gl.deleteShader(s),this.gl.deleteShader(n),e}compileShader(t,i){const e=this.gl.createShader(t);return this.gl.shaderSource(e,i),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)||(this.gl.deleteShader(e),console.error("ERROR compiling shaders",this.gl.getShaderInfoLog(e))),e}}class r{constructor(){this.current=0,this.previous=0,this.elapsed=0}get Total(){return this.current}get Elapsed(){return this.elapsed}get STotal(){return this.current/1e3}get SElapsed(){return this.elapsed/1e3}update(){this.previous=this.current,this.current=performance.now(),this.elapsed=this.current-this.previous}}class h{constructor(t){this.resolution=1,this.canResize=!0,this.parent=t||document.createElement("div"),t||(this.parent.id="Display",document.body.appendChild(this.parent)),this.canvas=document.createElement("canvas"),this.canvas.innerHTML="Your browser does not support HTML5.",this.canvas.id="DisplayRenderer",this.canvas.style.width="100%",this.canvas.style.height="100%",this.parent.appendChild(this.canvas),this.setFill(),this.resize()}update(t){this.resize()}setFill(){this.setSize(100,100,"%")}setSize(t,i,e="px"){this.parent.style.width=t+e,this.parent.style.height=(i||t)+e}resize(){const t=Math.round(this.canvas.clientWidth*devicePixelRatio*this.resolution),i=Math.round(this.canvas.clientHeight*devicePixelRatio*this.resolution);this.width==t&&this.height==i||(this.canvas.width=t,this.canvas.height=i)}get windowWidth(){return window.innerWidth}get windowHeight(){return window.innerHeight}get displayWidth(){return this.parent.clientWidth}get displayHeight(){return this.parent.clientHeight}get displayWidthPixelRatio(){return this.parent.clientWidth*devicePixelRatio}get displayHeightPixelRatio(){return this.parent.clientHeight*devicePixelRatio}get width(){return this.canvas.width}get height(){return this.canvas.height}get ratio(){return this.canvas.width/this.canvas.height}setResolution(t){var i,e,s;this.resolution=(e=0,(i=t)<(s=t)?i>e?i:e:s),this.resize()}getContext(t){return this.canvas.getContext(t)}getWebGLContext(){const t=this.canvas.getContext("webgl");if(!t)throw new Error("Error can't get WebGL context");return t}}class a{constructor(t){this.animationID=-1,this.started=!1,this.TIMEOUT_DELAY=100,this.display=new h(t),this.time=new r,addEventListener("resize",this.onResize.bind(this))}onResize(){this.stop(),this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.started&&this.run()},this.TIMEOUT_DELAY)}start(){return this.started=!0,this.run(),this}stop(){return cancelAnimationFrame(this.animationID),this.animationID=-1,!0}run(){this.time.update(),this.update(this.time),this.display.update(this.time),this.render(this.time),this.animationID=requestAnimationFrame(this.run.bind(this))}}class l{constructor(){this.stride=0,this.elements=[]}push(t,i,e,s){this.elements.push({name:i,type:e,count:t,normalized:s,offset:this.stride}),this.stride+=t*Float32Array.BYTES_PER_ELEMENT}getStride(){return this.stride}}class u{constructor(t,i){this.gl=t,this.bufferID=this.gl.createBuffer(),this.bind(),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(i),this.gl.STATIC_DRAW)}get id(){return this.bufferID}bind(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.bufferID)}unBind(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,0)}}class c{constructor(t,i){this.gl=t,this.bufferID=this.gl.createBuffer(),this.bind(),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),this.gl.STATIC_DRAW)}bind(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.bufferID)}unBind(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,0)}}class _{constructor(t){this.gl=t}addBuffer(t,i,e){let s,n;t.bind(),i.bind();for(let o=0;o<e.elements.length;o++)s=e.elements[o],n=this.gl.getAttribLocation(t.id,s.name),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i.id),this.gl.vertexAttribPointer(n,s.count,s.type,s.normalized,e.getStride(),s.offset),this.gl.enableVertexAttribArray(n)}}var d=e(0),p=e.n(d),g=e(1),m=e.n(g);class f{constructor(){this._left=!1,this._right=!1,this._up=!1,this._down=!1,this._zoom_in=!1,this._zoom_out=!1,this._rotate_clock=!1,this._rotate_anti=!1,this._space=!1,this._left_button=!1,this._is_dragging=!1,this._reset=!1,this._reset_all=!1,this._reset_position=!1,this._reset_rotation=!1,this._reset_scale=!1,this._x=0,this._y=0,this._prev_x=0,this._prev_y=0,this._wheel_delta_x=0,this._wheel_delta_y=0,this._is_rolling=!1}get Left(){return this._left}get Right(){return this._right}get Up(){return this._up}get Down(){return this._down}get ZoomIn(){return this._zoom_in}get ZoomOut(){return this._zoom_out}get RotateClock(){return this._rotate_clock}get RotateAnti(){return this._rotate_anti}get Space(){return this._space}get LeftButton(){return this._left_button}get IsDragging(){return this._is_dragging}get Reset(){return this._reset}get ResetAll(){return this._reset_all}get ResetPosition(){return this._reset_position}get ResetRotation(){return this._reset_rotation}get ResetScale(){return this._reset_scale}get X(){return this._x}get Y(){return this._y}get dX(){return this._x-this._prev_x}get dY(){return this._y-this._prev_y}get WheelDY(){return this._wheel_delta_y}get WheelDX(){return this._wheel_delta_x}get IsRolling(){return this._is_rolling}set IsRolling(t){this._is_rolling=t}registerMouseEvents(t){t.addEventListener("mousedown",this.onMouseDown.bind(this)),addEventListener("mousemove",this.onMouseMove.bind(this)),addEventListener("mouseup",this.onMouseUp.bind(this)),t.addEventListener("wheel",this.onWheel.bind(this)),addEventListener("focus",this.onFocus.bind(this)),addEventListener("blur",this.onBlur.bind(this))}registerTouchEvents(t){t.addEventListener("touchstart",this.onTouchStart.bind(this)),t.addEventListener("touchmove",this.onTouchMove.bind(this)),t.addEventListener("touchend",this.onTouchEnd.bind(this))}registerKeyEvents(){addEventListener("keydown",this.onKeyDown.bind(this)),addEventListener("keyup",this.onKeyUp.bind(this))}removeMouseEvents(){removeEventListener("mousedown",this.onMouseDown.bind(this)),removeEventListener("mousemove",this.onMouseMove.bind(this)),removeEventListener("mouseup",this.onMouseUp.bind(this))}removeKeyEvents(){removeEventListener("keydown",this.onKeyDown.bind(this)),removeEventListener("keyup",this.onKeyUp.bind(this))}update(){this._prev_x=this._x,this._prev_y=this._y}updateKey(t,i){switch(t){case"KeyA":case"ArrowLeft":this._left=i;break;case"KeyD":case"ArrowRight":this._right=i;break;case"KeyW":case"ArrowUp":this._up=i;break;case"KeyS":case"ArrowDown":this._down=i;break;case"KeyZ":case"ShiftLeft":this._zoom_in=i;break;case"KeyX":case"ControlLeft":this._zoom_out=i;break;case"KeyE":this._rotate_clock=i;break;case"KeyQ":this._rotate_anti=i;break;case"Space":this._space=i;break;case"Digit0":this._reset=i,this._reset_all=i;break;case"Digit7":this._reset=i,this._reset_position=i;break;case"Digit8":this._reset=i,this._reset_rotation=i;break;case"Digit9":this._reset=i,this._reset_scale=i}}onMouseDown(t){0==t.button&&(this._left_button=!0,this._is_dragging=!0,this._x=t.clientX*devicePixelRatio,this._y=t.clientY*devicePixelRatio,this._prev_x=this._x,this._prev_y=this._y)}onMouseMove(t){this._x=t.clientX*devicePixelRatio,this._y=t.clientY*devicePixelRatio}onMouseUp(t){0==t.button&&(this._left_button=!1,this._is_dragging=!1)}onTouchStart(t){t.preventDefault(),1==t.touches.length&&(this._left_button=!0,this._is_dragging=!0,this._x=t.touches[0].clientX*devicePixelRatio,this._y=t.touches[0].clientY*devicePixelRatio,this._prev_x=this._x,this._prev_y=this._y)}onTouchMove(t){t.preventDefault(),1==t.touches.length&&(this._left_button=!0,this._is_dragging=!0,this._x=t.touches[0].clientX*devicePixelRatio,this._y=t.touches[0].clientY*devicePixelRatio)}onTouchEnd(t){t.preventDefault(),1==t.touches.length&&(this._left_button=!1,this._is_dragging=!1,this._x=t.touches[0].clientX*devicePixelRatio,this._y=t.touches[0].clientY*devicePixelRatio)}onWheel(t){t.preventDefault(),this._wheel_delta_y=t.deltaY,this._wheel_delta_x=t.deltaX,this._is_rolling=!0}onKeyDown(t){this.updateKey(t.code,!0)}onKeyUp(t){this.updateKey(t.code,!1)}onFocus(t){}onBlur(t){this._left=!1,this._right=!1,this._up=!1,this._down=!1,this._zoom_in=!1,this._zoom_out=!1,this._rotate_anti=!1,this._rotate_clock=!1}}const v=[-1,1,0,1,0,0,1,0,1,1,1,0,0,1,0,1,1,1,1,-1,0,0,0,1,1,1,0,-1,-1,0,1,0,1,1,0,0],b=[0,1,2,0,2,3];class E extends a{constructor(t){super(t),this.scaleSpeed=1,this.resetTimer=0,this.ResetTime=2e3,this.input=new f,this.mandelbrotProp=new n,this.display.setResolution(this.mandelbrotProp.resolution),this.input.registerKeyEvents(),this.input.registerTouchEvents(this.display.canvas),this.input.registerMouseEvents(this.display.canvas),this.gl=this.display.getWebGLContext(),this.gl.clearColor(0,195/255,1,1),this.shader=new o(this.gl,p.a,m.a),this.shader.bind();const i=new u(this.gl,v),e=(new c(this.gl,b),new l);e.push(3,"a_position",this.gl.FLOAT,!1),e.push(4,"a_color",this.gl.FLOAT,!1),e.push(2,"a_uv",this.gl.FLOAT,!1);new _(this.gl).addBuffer(this.shader,i,e),this.mandelbrotProp.radius=2,this.shader.setUniform1f("u_radius",this.mandelbrotProp.radius),this.shader.setUniform1i("u_frac",0),this.shader.bind()}update(t){this.input.Left?this.mandelbrotProp.moveLeft():this.input.Right?this.mandelbrotProp.moveRight():this.mandelbrotProp.stopLeftRight(),this.input.Up?this.mandelbrotProp.moveUp():this.input.Down?this.mandelbrotProp.moveDown():this.mandelbrotProp.stopUpDown(),this.input.ZoomIn?this.mandelbrotProp.zoom(-t.SElapsed):this.input.ZoomOut?this.mandelbrotProp.zoom(t.SElapsed):this.input.IsRolling&&(this.mandelbrotProp.zoom(-t.SElapsed*this.input.WheelDY*.25),this.input.IsRolling=!this.input.IsRolling),this.input.RotateAnti?this.mandelbrotProp.rotate(-1):this.input.RotateClock&&this.mandelbrotProp.rotate(1),this.input.Reset?(this.resetTimer+=t.Elapsed,this.resetTimer>=this.ResetTime&&(this.input.ResetPosition&&this.mandelbrotProp.resetPosition(),this.input.ResetRotation&&this.mandelbrotProp.resetRotation(),this.input.ResetScale&&this.mandelbrotProp.resetZoom(),this.input.ResetAll&&this.mandelbrotProp.reset())):this.resetTimer=0,this.input.IsDragging&&this.mandelbrotProp.drag(this.input.dX/this.display.displayWidthPixelRatio*this.display.ratio,this.input.dY/this.display.displayHeightPixelRatio),this.input.update(),this.mandelbrotProp.update(t),this.shader.setUniform2fv("u_scale",this.mandelbrotProp.realScale),this.shader.setUniform2fv("u_position",this.mandelbrotProp.realPosition),this.shader.setUniform1f("u_rotation",this.mandelbrotProp.realRotation)}render(t){this.display.setResolution(this.mandelbrotProp.resolution),this.gl.viewport(0,0,this.display.width,this.display.height),this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.COLOR_BUFFER_BIT),this.shader.setUniform2f("u_resolution",this.display.width,this.display.height),this.shader.setUniform1f("u_time",t.STotal),this.shader.bind(),this.gl.drawElements(this.gl.TRIANGLES,b.length,this.gl.UNSIGNED_SHORT,0)}}window.onload=async()=>{(async function(){const t=document.querySelector("#app");new E(t).start()})().catch(console.error)}}]);